---
const commandSteps = [
  {
    num: '1',
    cmd: 'slope init',
    title: 'Initialize',
    detail: 'Set up SLOPE in your project. Pick a metaphor. Configure guards.',
  },
  {
    num: '2',
    cmd: 'slope briefing',
    title: 'Get briefed',
    detail: 'Get a pre-sprint briefing: risk index, performance snapshot, known issues.',
  },
  {
    num: '3',
    cmd: 'slope card',
    title: 'Check your card',
    detail: 'Check your performance card â€” rolling stats across multiple windows.',
  },
  {
    num: '4',
    cmd: 'slope review',
    title: 'Review the sprint',
    detail: 'Generate a sprint review with ticket-by-ticket analysis and improvement recommendations.',
  },
];

const promptSteps = [
  {
    num: '1',
    prompt: 'Initialize SLOPE in this project with the golf metaphor',
    title: 'Initialize',
    detail: 'The agent sets up .slope/config.json, enables guards, and configures your metaphor.',
  },
  {
    num: '2',
    prompt: 'Give me a pre-sprint briefing for my next sprint',
    title: 'Get briefed',
    detail: 'The agent reads your scorecards, surfaces hazards, and sets par based on your backlog.',
  },
  {
    num: '3',
    prompt: 'Show me my performance card',
    title: 'Check your card',
    detail: 'The agent computes rolling stats across your last 5, 10, and all-time sprints.',
  },
  {
    num: '4',
    prompt: 'Review this sprint and score it',
    title: 'Review the sprint',
    detail: 'The agent audits commits, scores each ticket, builds a scorecard, and updates your handicap.',
  },
];
---

<section id="getting-started" class="py-24 sm:py-32">
  <div class="max-w-5xl mx-auto px-6">
    <div class="text-center mb-12" data-reveal>
      <p class="text-emerald text-xs font-mono uppercase tracking-widest mb-3">Quick Start</p>
      <h2 class="font-heading font-bold text-3xl sm:text-4xl mb-4">
        Four steps. First sprint.
      </h2>
      <p class="text-text-secondary max-w-2xl mx-auto">
        Get started with CLI commands or natural language prompts. Same flow, your choice.
      </p>
    </div>

    <!-- Mode selector -->
    <div class="flex justify-center mb-8" data-reveal>
      <div class="inline-flex rounded-lg border border-border bg-bg-surface/50 p-1 gap-1">
        <button data-start-mode="commands" class="start-mode-pill px-5 py-2 rounded-md text-sm font-heading font-bold transition-colors bg-emerald/10 text-emerald border border-emerald/20">
          Commands
        </button>
        <button data-start-mode="prompts" class="start-mode-pill px-5 py-2 rounded-md text-sm font-heading font-bold transition-colors text-text-muted hover:text-text-secondary border border-transparent">
          Prompts
        </button>
      </div>
    </div>

    <!-- Install toggle (commands mode only) -->
    <div id="install-toggle" class="flex flex-col items-center gap-3 mb-10" data-reveal>
      <div class="inline-flex rounded-lg border border-border bg-bg-surface/50 p-0.5">
        <button data-pkg="npm" class="px-4 py-1.5 rounded-md text-xs font-mono font-medium transition-colors bg-emerald/10 text-emerald border border-emerald/20">npm</button>
        <button data-pkg="pnpm" class="px-4 py-1.5 rounded-md text-xs font-mono font-medium transition-colors text-text-muted hover:text-text-secondary">pnpm</button>
        <button data-pkg="bun" class="px-4 py-1.5 rounded-md text-xs font-mono font-medium transition-colors text-text-muted hover:text-text-secondary">bun</button>
      </div>
      <div class="inline-flex items-center gap-3 px-5 py-2.5 rounded-lg border border-border bg-bg-card font-mono text-sm">
        <span class="text-text-muted">$</span>
        <code data-install-cmd class="text-emerald">npm install -g @srbryers/cli</code>
        <button data-install-copy class="ml-2 p-1 rounded hover:bg-bg-surface transition-colors text-text-muted hover:text-emerald" aria-label="Copy install command">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" class="pointer-events-none" aria-hidden="true">
            <rect x="9" y="9" width="13" height="13" rx="2" stroke="currentColor" stroke-width="2" />
            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" stroke="currentColor" stroke-width="2" />
          </svg>
        </button>
      </div>
    </div>

    <!-- Commands mode -->
    <div id="start-commands" class="grid sm:grid-cols-2 gap-6" data-stagger>
      {commandSteps.map(({ num, cmd, title, detail }) => (
        <div class="rounded-xl border border-border bg-bg-card p-6 hover:border-emerald/20 transition-colors">
          <div class="flex items-center gap-3 mb-4">
            <div class="w-8 h-8 rounded-lg bg-emerald/10 flex items-center justify-center shrink-0">
              <span class="text-emerald text-sm font-bold">{num}</span>
            </div>
            <code class="text-emerald text-sm font-mono">{cmd}</code>
          </div>
          <h3 class="font-heading font-bold text-lg text-text-primary mb-1">{title}</h3>
          <p class="text-text-muted text-sm leading-relaxed">{detail}</p>
        </div>
      ))}
    </div>

    <!-- Prompts mode (hidden by default) -->
    <div id="start-prompts" class="grid sm:grid-cols-2 gap-6 hidden" data-stagger>
      {promptSteps.map(({ num, prompt, title, detail }) => (
        <div class="rounded-xl border border-border bg-bg-card p-6 hover:border-emerald/20 transition-colors">
          <div class="flex items-center gap-3 mb-4">
            <div class="w-8 h-8 rounded-lg bg-emerald/10 flex items-center justify-center shrink-0">
              <span class="text-emerald text-sm font-bold">{num}</span>
            </div>
          </div>
          <h3 class="font-heading font-bold text-lg text-text-primary mb-1">{title}</h3>
          <p class="text-emerald text-sm font-mono leading-relaxed mb-2 bg-emerald/5 border border-emerald/10 rounded-lg px-3 py-2">"{prompt}"</p>
          <p class="text-text-muted text-sm leading-relaxed">{detail}</p>
        </div>
      ))}
    </div>

    <!-- Pro Tips -->
    <div class="mt-16 text-center" data-reveal>
      <p class="text-emerald text-xs font-mono uppercase tracking-widest mb-3">Pro Tips</p>
      <h3 class="font-heading font-bold text-2xl sm:text-3xl mb-3">Get more from every <span data-term="vocabulary.sprint">hole</span>.</h3>
      <p class="text-text-secondary max-w-2xl mx-auto mb-8">Workflow habits that separate <span data-term="scoreLabels.birdie">birdies</span> from <span data-term="scoreLabels.bogey">bogeys</span>.</p>
    </div>
    <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-4" data-reveal data-stagger>
      <div class="rounded-xl border border-border bg-bg-card p-5 hover:border-emerald/20 transition-colors">
        <span class="text-lg" aria-hidden="true">ðŸ“‹</span>
        <p class="text-sm font-medium text-text-primary mt-2"><span data-term="vocabulary.briefing">Pre-round briefing</span> before code</p>
        <p class="text-text-muted text-xs mt-1 leading-relaxed">Get your hazard index and known gotchas before writing a single line.</p>
        <code class="inline-block mt-2 text-xs font-mono text-emerald bg-emerald/5 border border-emerald/10 rounded px-2 py-0.5">slope briefing</code>
      </div>
      <div class="rounded-xl border border-border bg-bg-card p-5 hover:border-emerald/20 transition-colors">
        <span class="text-lg" aria-hidden="true">ðŸŽ¯</span>
        <p class="text-sm font-medium text-text-primary mt-2">Declare your approach</p>
        <p class="text-text-muted text-xs mt-1 leading-relaxed">Pick your <span data-term="vocabulary.club">club</span> so the <span data-term="vocabulary.scorecard">scorecard</span> captures complexity, not just outcome.</p>
        <code class="inline-block mt-2 text-xs font-mono text-emerald bg-emerald/5 border border-emerald/10 rounded px-2 py-0.5">slope claim</code>
      </div>
      <div class="rounded-xl border border-border bg-bg-card p-5 hover:border-emerald/20 transition-colors">
        <span class="text-lg" aria-hidden="true">ðŸ’¾</span>
        <p class="text-sm font-medium text-text-primary mt-2">Commit early, push often</p>
        <p class="text-text-muted text-xs mt-1 leading-relaxed">The last push is your recovery point. Everything since is at risk.</p>
      </div>
      <div class="rounded-xl border border-border bg-bg-card p-5 hover:border-emerald/20 transition-colors">
        <span class="text-lg" aria-hidden="true">ðŸ“Š</span>
        <p class="text-sm font-medium text-text-primary mt-2">Check miss patterns</p>
        <p class="text-text-muted text-xs mt-1 leading-relaxed">A <span data-term="scoreLabels.bogey">bogey</span> from going <span data-term="missDirections.long">Long</span> is different from going <span data-term="missDirections.left">Left</span>. Directional data matters.</p>
        <code class="inline-block mt-2 text-xs font-mono text-emerald bg-emerald/5 border border-emerald/10 rounded px-2 py-0.5">slope card</code>
      </div>
    </div>

    <!-- Quick Reference -->
    <div class="mt-16 rounded-xl border border-border bg-bg-card overflow-hidden" data-reveal>
      <div class="flex items-center justify-between px-6 py-4 border-b border-border-subtle">
        <div>
          <p class="font-heading font-bold text-lg text-text-primary">Quick Reference</p>
          <p class="text-text-muted text-xs mt-0.5">Scores, <span data-term="vocabulary.club">club</span>s, and hazards at a glance</p>
        </div>
        <a href="/docs#cheat-sheet" class="text-emerald text-xs font-medium hover:underline shrink-0">Full cheat sheet &rarr;</a>
      </div>
      <div class="grid sm:grid-cols-3 divide-y sm:divide-y-0 sm:divide-x divide-border-subtle">
        <!-- Scoring -->
        <div class="px-5 py-4">
          <p class="text-xs font-mono uppercase tracking-wider text-text-muted mb-3">Scoring</p>
          <div class="space-y-1.5">
            <div class="flex items-baseline gap-2"><span class="font-mono text-xs font-medium text-gold w-14" data-term="scoreLabels.eagle">Eagle</span><span class="text-text-muted text-xs">-2</span></div>
            <div class="flex items-baseline gap-2"><span class="font-mono text-xs font-medium text-emerald w-14" data-term="scoreLabels.birdie">Birdie</span><span class="text-text-muted text-xs">-1</span></div>
            <div class="flex items-baseline gap-2"><span class="font-mono text-xs font-medium text-text-primary w-14" data-term="scoreLabels.par">Par</span><span class="text-text-muted text-xs">0</span></div>
            <div class="flex items-baseline gap-2"><span class="font-mono text-xs font-medium text-amber-400 w-14" data-term="scoreLabels.bogey">Bogey</span><span class="text-text-muted text-xs">+1</span></div>
            <div class="flex items-baseline gap-2"><span class="font-mono text-xs font-medium text-red-400 w-14" data-term="scoreLabels.double_bogey">Double</span><span class="text-text-muted text-xs">+2</span></div>
          </div>
        </div>
        <!-- Clubs -->
        <div class="px-5 py-4">
          <p class="text-xs font-mono uppercase tracking-wider text-text-muted mb-3"><span data-term="vocabulary.club">Clubs</span></p>
          <div class="space-y-1.5">
            <div class="flex items-baseline gap-2"><span class="font-mono text-xs font-medium text-emerald w-20" data-term="clubs.driver">Driver</span><span class="text-text-muted text-xs">High risk</span></div>
            <div class="flex items-baseline gap-2"><span class="font-mono text-xs font-medium text-emerald w-20" data-term="clubs.long_iron">Long Iron</span><span class="text-text-muted text-xs">Multi-pkg</span></div>
            <div class="flex items-baseline gap-2"><span class="font-mono text-xs font-medium text-emerald w-20" data-term="clubs.short_iron">Short Iron</span><span class="text-text-muted text-xs">Standard</span></div>
            <div class="flex items-baseline gap-2"><span class="font-mono text-xs font-medium text-emerald w-20" data-term="clubs.wedge">Wedge</span><span class="text-text-muted text-xs">Small fix</span></div>
            <div class="flex items-baseline gap-2"><span class="font-mono text-xs font-medium text-emerald w-20" data-term="clubs.putter">Putter</span><span class="text-text-muted text-xs">Trivial</span></div>
          </div>
        </div>
        <!-- Hazards -->
        <div class="px-5 py-4">
          <p class="text-xs font-mono uppercase tracking-wider text-text-muted mb-3">Hazards</p>
          <div class="space-y-1.5">
            <div class="flex items-baseline gap-2"><span class="font-mono text-xs font-medium text-gold w-16" data-term="hazards.bunker">Bunker</span><span class="text-text-muted text-xs">Known gotcha</span></div>
            <div class="flex items-baseline gap-2"><span class="font-mono text-xs font-medium text-blue-400 w-16" data-term="hazards.water">Water</span><span class="text-text-muted text-xs">Breaking change</span></div>
            <div class="flex items-baseline gap-2"><span class="font-mono text-xs font-medium text-red-400 w-16" data-term="hazards.ob">OB</span><span class="text-text-muted text-xs">Scope creep</span></div>
            <div class="flex items-baseline gap-2"><span class="font-mono text-xs font-medium text-text-secondary w-16" data-term="hazards.rough">Rough</span><span class="text-text-muted text-xs">Tech debt</span></div>
            <div class="flex items-baseline gap-2"><span class="font-mono text-xs font-medium text-emerald w-16" data-term="hazards.trees">Trees</span><span class="text-text-muted text-xs">Blocker</span></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  import { initInstallToggle } from '../scripts/interactions';
  initInstallToggle();

  // Mode toggle
  const pills = document.querySelectorAll<HTMLButtonElement>('[data-start-mode]');
  const commandsPanel = document.getElementById('start-commands');
  const promptsPanel = document.getElementById('start-prompts');
  const installToggle = document.getElementById('install-toggle');

  pills.forEach((pill) => {
    pill.addEventListener('click', () => {
      const mode = pill.dataset.startMode;

      // Update pill styles
      pills.forEach((p) => {
        if (p.dataset.startMode === mode) {
          p.classList.add('bg-emerald/10', 'text-emerald', 'border-emerald/20');
          p.classList.remove('text-text-muted', 'hover:text-text-secondary', 'border-transparent');
        } else {
          p.classList.remove('bg-emerald/10', 'text-emerald', 'border-emerald/20');
          p.classList.add('text-text-muted', 'hover:text-text-secondary', 'border-transparent');
        }
      });

      // Toggle panels
      if (mode === 'commands') {
        commandsPanel?.classList.remove('hidden');
        promptsPanel?.classList.add('hidden');
        installToggle?.classList.remove('hidden');
      } else {
        commandsPanel?.classList.add('hidden');
        promptsPanel?.classList.remove('hidden');
        installToggle?.classList.add('hidden');
      }
    });
  });
</script>
